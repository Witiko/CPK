var $jscomp={scope:{},getGlobal:function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global?global:a}};$jscomp.global=$jscomp.getGlobal(this);$jscomp.initSymbol=function(){$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol);$jscomp.initSymbol=function(){}};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(a){return"jscomp_symbol_"+a+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();$jscomp.global.Symbol.iterator||($jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));$jscomp.initSymbolIterator=function(){}};$jscomp.makeIterator=function(a){$jscomp.initSymbolIterator();if(a[$jscomp.global.Symbol.iterator])return a[$jscomp.global.Symbol.iterator]();var b=0;return{next:function(){return b==a.length?{done:!0}:{done:!1,value:a[b++]}}}};
$jscomp.arrayFromIterator=function(a){for(var b,c=[];!(b=a.next()).done;)c.push(b.value);return c};$jscomp.arrayFromIterable=function(a){return a instanceof Array?a:$jscomp.arrayFromIterator($jscomp.makeIterator(a))};
$jscomp.inherits=function(a,b){function c(){}c.prototype=b.prototype;a.prototype=new c;a.prototype.constructor=a;for(var d in b)if($jscomp.global.Object.defineProperties){var e=$jscomp.global.Object.getOwnPropertyDescriptor(b,d);e&&$jscomp.global.Object.defineProperty(a,d,e)}else a[d]=b[d]};$jscomp.array=$jscomp.array||{};$jscomp.array.done_=function(){return{done:!0,value:void 0}};
$jscomp.array.arrayIterator_=function(a,b){a instanceof String&&(a=String(a));var c=0;$jscomp.initSymbol();$jscomp.initSymbolIterator();var d={};$jscomp.initSymbol();$jscomp.initSymbolIterator();var e=(d.next=function(){if(c<a.length){var d=c++;return{value:b(d,a[d]),done:!1}}e.next=$jscomp.array.done_;return $jscomp.array.done_()},d[Symbol.iterator]=function(){return e},d);return e};
$jscomp.array.findInternal_=function(a,b,c){a instanceof String&&(a=String(a));for(var d=a.length,e=0;e<d;e++){var f=a[e];if(b.call(c,f,e,a))return{i:e,v:f}}return{i:-1,v:void 0}};
$jscomp.array.from=function(a,b,c){b=void 0===b?function(a){return a}:b;var d=[];$jscomp.initSymbol();$jscomp.initSymbolIterator();$jscomp.initSymbol();$jscomp.initSymbolIterator();if(a[Symbol.iterator]){$jscomp.initSymbol();$jscomp.initSymbolIterator();$jscomp.initSymbol();$jscomp.initSymbolIterator();a=a[Symbol.iterator]();for(var e;!(e=a.next()).done;)d.push(b.call(c,e.value))}else{e=a.length;for(var f=0;f<e;f++)d.push(b.call(c,a[f]))}return d};
$jscomp.array.of=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];return $jscomp.array.from(b)};$jscomp.array.entries=function(){return $jscomp.array.arrayIterator_(this,function(a,b){return[a,b]})};$jscomp.array.installHelper_=function(a,b){!Array.prototype[a]&&Object.defineProperties&&Object.defineProperty&&Object.defineProperty(Array.prototype,a,{configurable:!0,enumerable:!1,writable:!0,value:b})};
$jscomp.array.entries$install=function(){$jscomp.array.installHelper_("entries",$jscomp.array.entries)};$jscomp.array.keys=function(){return $jscomp.array.arrayIterator_(this,function(a){return a})};$jscomp.array.keys$install=function(){$jscomp.array.installHelper_("keys",$jscomp.array.keys)};$jscomp.array.values=function(){return $jscomp.array.arrayIterator_(this,function(a,b){return b})};$jscomp.array.values$install=function(){$jscomp.array.installHelper_("values",$jscomp.array.values)};
$jscomp.array.copyWithin=function(a,b,c){var d=this.length;a=Number(a);b=Number(b);c=Number(null!=c?c:d);if(a<b)for(c=Math.min(c,d);b<c;)b in this?this[a++]=this[b++]:(delete this[a++],b++);else for(c=Math.min(c,d+b-a),a+=c-b;c>b;)--c in this?this[--a]=this[c]:delete this[a];return this};$jscomp.array.copyWithin$install=function(){$jscomp.array.installHelper_("copyWithin",$jscomp.array.copyWithin)};
$jscomp.array.fill=function(a,b,c){null!=c&&a.length||(c=this.length||0);c=Number(c);for(b=Number((void 0===b?0:b)||0);b<c;b++)this[b]=a;return this};$jscomp.array.fill$install=function(){$jscomp.array.installHelper_("fill",$jscomp.array.fill)};$jscomp.array.find=function(a,b){return $jscomp.array.findInternal_(this,a,b).v};$jscomp.array.find$install=function(){$jscomp.array.installHelper_("find",$jscomp.array.find)};
$jscomp.array.findIndex=function(a,b){return $jscomp.array.findInternal_(this,a,b).i};$jscomp.array.findIndex$install=function(){$jscomp.array.installHelper_("findIndex",$jscomp.array.findIndex)};$jscomp.Map=function(a){a=void 0===a?[]:a;this.data_={};this.head_=$jscomp.Map.createHead_();this.size=0;if(a){a=$jscomp.makeIterator(a);for(var b=a.next();!b.done;b=a.next())b=b.value,this.set(b[0],b[1])}};
$jscomp.Map.checkBrowserConformance_=function(){var a=$jscomp.global.Map;if(!a||!a.prototype.entries||!Object.seal)return!1;try{var b=Object.seal({x:4}),c=new a($jscomp.makeIterator([[b,"s"]]));if("s"!=c.get(b)||1!=c.size||c.get({x:4})||c.set({x:4},"t")!=c||2!=c.size)return!1;var d=c.entries(),e=d.next();if(e.done||e.value[0]!=b||"s"!=e.value[1])return!1;e=d.next();return e.done||4!=e.value[0].x||"t"!=e.value[1]||!d.next().done?!1:!0}catch(f){return!1}};
$jscomp.Map.createHead_=function(){var a={};return a.previous=a.next=a.head=a};$jscomp.Map.getId_=function(a){if(!(a instanceof Object))return String(a);$jscomp.Map.key_ in a||a instanceof Object&&Object.isExtensible&&Object.isExtensible(a)&&$jscomp.Map.defineProperty_(a,$jscomp.Map.key_,++$jscomp.Map.index_);return $jscomp.Map.key_ in a?a[$jscomp.Map.key_]:" "+a};
$jscomp.Map.prototype.set=function(a,b){var c=this.maybeGetEntry_(a),d=c.id,e=c.list,c=c.entry;e||(e=this.data_[d]=[]);c?c.value=b:(c={next:this.head_,previous:this.head_.previous,head:this.head_,key:a,value:b},e.push(c),this.head_.previous.next=c,this.head_.previous=c,this.size++);return this};
$jscomp.Map.prototype["delete"]=function(a){var b=this.maybeGetEntry_(a);a=b.id;var c=b.list,d=b.index;return(b=b.entry)&&c?(c.splice(d,1),c.length||delete this.data_[a],b.previous.next=b.next,b.next.previous=b.previous,b.head=null,this.size--,!0):!1};$jscomp.Map.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=$jscomp.Map.createHead_();this.size=0};$jscomp.Map.prototype.has=function(a){return!!this.maybeGetEntry_(a).entry};
$jscomp.Map.prototype.get=function(a){return(a=this.maybeGetEntry_(a).entry)&&a.value};$jscomp.Map.prototype.maybeGetEntry_=function(a){var b=$jscomp.Map.getId_(a),c=this.data_[b];if(c)for(var d=0;d<c.length;d++){var e=c[d];if(a!==a&&e.key!==e.key||a===e.key)return{id:b,list:c,index:d,entry:e}}return{id:b,list:c,index:-1,entry:void 0}};$jscomp.Map.prototype.entries=function(){return this.iter_(function(a){return[a.key,a.value]})};$jscomp.Map.prototype.keys=function(){return this.iter_(function(a){return a.key})};
$jscomp.Map.prototype.values=function(){return this.iter_(function(a){return a.value})};$jscomp.Map.prototype.forEach=function(a,b){for(var c=$jscomp.makeIterator(this.entries()),d=c.next();!d.done;d=c.next())d=d.value,a.call(b,d[1],d[0],this)};
$jscomp.Map.prototype.iter_=function(a){var b=this,c=this.head_;$jscomp.initSymbol();$jscomp.initSymbolIterator();var d={};$jscomp.initSymbol();$jscomp.initSymbolIterator();return d.next=function(){if(c){for(;c.head!=b.head_;)c=c.previous;for(;c.next!=c.head;)return c=c.next,{done:!1,value:a(c)};c=null}return{done:!0,value:void 0}},d[Symbol.iterator]=function(){return this},d};$jscomp.Map.index_=0;
$jscomp.Map.defineProperty_=Object.defineProperty?function(a,b,c){Object.defineProperty(a,b,{value:String(c)})}:function(a,b,c){a[b]=String(c)};$jscomp.Map.Entry_=function(){};$jscomp.Map.ASSUME_NO_NATIVE=!1;
$jscomp.Map$install=function(){$jscomp.initSymbol();$jscomp.initSymbolIterator();!$jscomp.Map.ASSUME_NO_NATIVE&&$jscomp.Map.checkBrowserConformance_()?$jscomp.Map=$jscomp.global.Map:($jscomp.initSymbol(),$jscomp.initSymbolIterator(),$jscomp.initSymbol(),$jscomp.initSymbolIterator(),$jscomp.Map.prototype[Symbol.iterator]=$jscomp.Map.prototype.entries,$jscomp.initSymbol(),$jscomp.initSymbol(),$jscomp.Map.key_=Symbol("map-id-key"));$jscomp.Map$install=function(){}};$jscomp.math=$jscomp.math||{};
$jscomp.math.clz32=function(a){a=Number(a)>>>0;if(0===a)return 32;var b=0;0===(a&4294901760)&&(a<<=16,b+=16);0===(a&4278190080)&&(a<<=8,b+=8);0===(a&4026531840)&&(a<<=4,b+=4);0===(a&3221225472)&&(a<<=2,b+=2);0===(a&2147483648)&&b++;return b};$jscomp.math.imul=function(a,b){a=Number(a);b=Number(b);var c=a&65535,d=b&65535;return c*d+((a>>>16&65535)*d+c*(b>>>16&65535)<<16>>>0)|0};$jscomp.math.sign=function(a){a=Number(a);return 0===a||isNaN(a)?a:0<a?1:-1};
$jscomp.math.log10=function(a){return Math.log(a)/Math.LN10};$jscomp.math.log2=function(a){return Math.log(a)/Math.LN2};$jscomp.math.log1p=function(a){a=Number(a);if(.25>a&&-.25<a){for(var b=a,c=1,d=a,e=0,f=1;e!=d;)b*=a,f*=-1,d=(e=d)+f*b/++c;return d}return Math.log(1+a)};$jscomp.math.expm1=function(a){a=Number(a);if(.25>a&&-.25<a){for(var b=a,c=1,d=a,e=0;e!=d;)b*=a/++c,d=(e=d)+b;return d}return Math.exp(a)-1};$jscomp.math.cosh=function(a){a=Number(a);return(Math.exp(a)+Math.exp(-a))/2};
$jscomp.math.sinh=function(a){a=Number(a);return 0===a?a:(Math.exp(a)-Math.exp(-a))/2};$jscomp.math.tanh=function(a){a=Number(a);if(0===a)return a;var b=Math.exp(2*-Math.abs(a)),b=(1-b)/(1+b);return 0>a?-b:b};$jscomp.math.acosh=function(a){a=Number(a);return Math.log(a+Math.sqrt(a*a-1))};$jscomp.math.asinh=function(a){a=Number(a);if(0===a)return a;var b=Math.log(Math.abs(a)+Math.sqrt(a*a+1));return 0>a?-b:b};
$jscomp.math.atanh=function(a){a=Number(a);return($jscomp.math.log1p(a)-$jscomp.math.log1p(-a))/2};
$jscomp.math.hypot=function(a,b,c){for(var d=[],e=2;e<arguments.length;++e)d[e-2]=arguments[e];a=Number(a);b=Number(b);for(var f=Math.max(Math.abs(a),Math.abs(b)),k=$jscomp.makeIterator(d),e=k.next();!e.done;e=k.next())f=Math.max(f,Math.abs(e.value));if(1E100<f||1E-100>f){a/=f;b/=f;k=a*a+b*b;d=$jscomp.makeIterator(d);for(e=d.next();!e.done;e=d.next())e=e.value,e=Number(e)/f,k+=e*e;return Math.sqrt(k)*f}f=a*a+b*b;d=$jscomp.makeIterator(d);for(e=d.next();!e.done;e=d.next())e=e.value,e=Number(e),f+=
e*e;return Math.sqrt(f)};$jscomp.math.trunc=function(a){a=Number(a);if(isNaN(a)||Infinity===a||-Infinity===a||0===a)return a;var b=Math.floor(Math.abs(a));return 0>a?-b:b};$jscomp.math.cbrt=function(a){if(0===a)return a;a=Number(a);var b=Math.pow(Math.abs(a),1/3);return 0>a?-b:b};$jscomp.number=$jscomp.number||{};$jscomp.number.isFinite=function(a){return"number"!==typeof a?!1:!isNaN(a)&&Infinity!==a&&-Infinity!==a};
$jscomp.number.isInteger=function(a){return $jscomp.number.isFinite(a)?a===Math.floor(a):!1};$jscomp.number.isNaN=function(a){return"number"===typeof a&&isNaN(a)};$jscomp.number.isSafeInteger=function(a){return $jscomp.number.isInteger(a)&&Math.abs(a)<=$jscomp.number.MAX_SAFE_INTEGER};$jscomp.number.EPSILON=Math.pow(2,-52);$jscomp.number.MAX_SAFE_INTEGER=9007199254740991;$jscomp.number.MIN_SAFE_INTEGER=-9007199254740991;$jscomp.object=$jscomp.object||{};
$jscomp.object.assign=function(a,b){for(var c=[],d=1;d<arguments.length;++d)c[d-1]=arguments[d];c=$jscomp.makeIterator(c);for(d=c.next();!d.done;d=c.next())if(d=d.value)for(var e in d)Object.prototype.hasOwnProperty.call(d,e)&&(a[e]=d[e]);return a};$jscomp.object.is=function(a,b){return a===b?0!==a||1/a===1/b:a!==a&&b!==b};$jscomp.Set=function(a){a=void 0===a?[]:a;this.map_=new $jscomp.Map;if(a){a=$jscomp.makeIterator(a);for(var b=a.next();!b.done;b=a.next())this.add(b.value)}this.size=this.map_.size};
$jscomp.Set.checkBrowserConformance_=function(){var a=$jscomp.global.Set;if(!a||!a.prototype.entries||!Object.seal)return!1;var b=Object.seal({x:4}),a=new a($jscomp.makeIterator([b]));if(a.has(b)||1!=a.size||a.add(b)!=a||1!=a.size||a.add({x:4})!=a||2!=a.size)return!1;var a=a.entries(),c=a.next();if(c.done||c.value[0]!=b||c.value[1]!=b)return!1;c=a.next();return c.done||c.value[0]==b||4!=c.value[0].x||c.value[1]!=c.value[0]?!1:a.next().done};
$jscomp.Set.prototype.add=function(a){this.map_.set(a,a);this.size=this.map_.size;return this};$jscomp.Set.prototype["delete"]=function(a){a=this.map_["delete"](a);this.size=this.map_.size;return a};$jscomp.Set.prototype.clear=function(){this.map_.clear();this.size=0};$jscomp.Set.prototype.has=function(a){return this.map_.has(a)};$jscomp.Set.prototype.entries=function(){return this.map_.entries()};$jscomp.Set.prototype.values=function(){return this.map_.values()};
$jscomp.Set.prototype.forEach=function(a,b){var c=this;this.map_.forEach(function(d){return a.call(b,d,d,c)})};$jscomp.Set.ASSUME_NO_NATIVE=!1;$jscomp.Set$install=function(){!$jscomp.Set.ASSUME_NO_NATIVE&&$jscomp.Set.checkBrowserConformance_()?$jscomp.Set=$jscomp.global.Set:($jscomp.Map$install(),$jscomp.initSymbol(),$jscomp.initSymbolIterator(),$jscomp.initSymbol(),$jscomp.initSymbolIterator(),$jscomp.Set.prototype[Symbol.iterator]=$jscomp.Set.prototype.values);$jscomp.Set$install=function(){}};
$jscomp.string=$jscomp.string||{};$jscomp.string.noNullOrUndefined_=function(a,b){if(null==a)throw new TypeError("The 'this' value for String.prototype."+b+" must not be null or undefined");};$jscomp.string.noRegExp_=function(a,b){if(a instanceof RegExp)throw new TypeError("First argument to String.prototype."+b+" must not be a regular expression");};
$jscomp.string.fromCodePoint=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];for(var c="",b=$jscomp.makeIterator(b),d=b.next();!d.done;d=b.next()){d=d.value;d=+d;if(0>d||1114111<d||d!==Math.floor(d))throw new RangeError("invalid_code_point "+d);65535>=d?c+=String.fromCharCode(d):(d-=65536,c+=String.fromCharCode(d>>>10&1023|55296),c+=String.fromCharCode(d&1023|56320))}return c};
$jscomp.string.repeat=function(a){$jscomp.string.noNullOrUndefined_(this,"repeat");var b=String(this);if(0>a||1342177279<a)throw new RangeError("Invalid count value");a|=0;for(var c="";a;)if(a&1&&(c+=b),a>>>=1)b+=b;return c};$jscomp.string.repeat$install=function(){String.prototype.repeat||(String.prototype.repeat=$jscomp.string.repeat)};
$jscomp.string.codePointAt=function(a){$jscomp.string.noNullOrUndefined_(this,"codePointAt");var b=String(this),c=b.length;a=Number(a)||0;if(0<=a&&a<c){a|=0;var d=b.charCodeAt(a);if(55296>d||56319<d||a+1===c)return d;a=b.charCodeAt(a+1);return 56320>a||57343<a?d:1024*(d-55296)+a+9216}};$jscomp.string.codePointAt$install=function(){String.prototype.codePointAt||(String.prototype.codePointAt=$jscomp.string.codePointAt)};
$jscomp.string.includes=function(a,b){b=void 0===b?0:b;$jscomp.string.noRegExp_(a,"includes");$jscomp.string.noNullOrUndefined_(this,"includes");return-1!==String(this).indexOf(a,b)};$jscomp.string.includes$install=function(){String.prototype.includes||(String.prototype.includes=$jscomp.string.includes)};
$jscomp.string.startsWith=function(a,b){b=void 0===b?0:b;$jscomp.string.noRegExp_(a,"startsWith");$jscomp.string.noNullOrUndefined_(this,"startsWith");var c=String(this);a+="";for(var d=c.length,e=a.length,f=Math.max(0,Math.min(b|0,c.length)),k=0;k<e&&f<d;)if(c[f++]!=a[k++])return!1;return k>=e};$jscomp.string.startsWith$install=function(){String.prototype.startsWith||(String.prototype.startsWith=$jscomp.string.startsWith)};
$jscomp.string.endsWith=function(a,b){$jscomp.string.noRegExp_(a,"endsWith");$jscomp.string.noNullOrUndefined_(this,"endsWith");var c=String(this);a+="";void 0===b&&(b=c.length);for(var d=Math.max(0,Math.min(b|0,c.length)),e=a.length;0<e&&0<d;)if(c[--d]!=a[--e])return!1;return 0>=e};$jscomp.string.endsWith$install=function(){String.prototype.endsWith||(String.prototype.endsWith=$jscomp.string.endsWith)};(function(){angular.module("favorites",[])})();(function(){function a(a){var c=!1,d="undefined"!==typeof __notif;return{favAdded:function(){if(!0===d&&!1===c){c=!0;var e=a("you_have_unsaved_favorites");__notif.addNotification(e,"favs")}},allFavsRemoved:function(){!0===d&&(__notif.helper.pointers.global.children(".notif-favs").remove(),0===__notif.sourcesRead.unreadCount&&(c=!1,__notif.warning.hide(),__notif.helper.pointers.global.children().first().show()))}}}angular.module("favorites").factory("favsNotifications",a);a.$inject=["translateFilter"]})();(function(){angular.module("favorites").value("Favorite",function(){var a={title:{link:void 0,value:void 0},author:{link:void 0,value:void 0},published:void 0,format:{iconClass:void 0,value:void 0},image:void 0,icon:{value:void 0,style:void 0},created:(new Date).getTime()},b=this;b.parseCurrentRecord=function(){var a=$("table[summary]"),d=a.find("tbody tr td[property=author] a");0===d.length&&(d=a.find("tbody tr td[property=creator] a"),0===d.length&&(d=a.find("tbody tr td span[property=contributor] a")));
var e=a.find("tbody tr td div.iconlabel");b.titleLink(location.pathname);b.title(function(){var b=a.siblings("h3");if(b.length)return b.text();console.error("Parsing record title failed!")}());b.authorLink(function(){var a=d.prop("href");if("string"===typeof a)return a;console.error("Parsing author's link failed!")}());b.author(function(){var a=d.text();if("string"===typeof a)return a;console.error("Parsing author's name failed!")}());b.formatIconClass(function(){var a=e.children("i");if(a.length)return a.attr("class");
console.error("Parsing format icon class failed!")}());b.format(function(){var a=e.children("span");if(a.length)return a.attr("data-orig");console.error("Parsing record format failed!")}());b.published(function(){var b=a.find("tbody tr td span[property=publicationDate]");if(b.length)return b.text();console.error("Parsing publication year failed!")}());b.image(function(){var d=a.parent().siblings("div.col-sm-3");if(d.length){var e=d.find("img");if(e.length)return e.attr("src");d=d.find("i[class][style]");
d.length?(b.icon(d.attr("class")),b.iconStyle(d.attr("style"))):console.error("Parsing record image source or icon failed!")}else console.error("Parsing record image's parent division failed!")}());return b};b.fromObject=function(c){"object"!==typeof c?console.error("Trying to create Favorite from object, but no object passed"):c.hasOwnProperty("created")?a=c:console.error("Missing timestamp of the object!");return b};b.toObject=function(){return a};b.toString=function(){return JSON.stringify(a)};
b.titleLink=function(c){if("undefined"===typeof c)return a.title.link;a.title.link=c;return b};b.title=function(c){if("undefined"===typeof c)return a.title.value;a.title.value=c;return b};b.authorLink=function(c){if("undefined"===typeof c)return a.author.link;a.author.link=c;return b};b.author=function(c){if("undefined"===typeof c)return a.author.value;a.author.value=c;return b};b.published=function(c){if("undefined"===typeof c)return a.published;a.published=c;return b};b.formatIconClass=function(c){if("undefined"===
typeof c)return a.format.iconClass;a.format.iconClass=c;return b};b.format=function(c){if("undefined"===typeof c)return a.format.value;a.format.value=c;return b};b.image=function(c){if("undefined"===typeof c)return a.image;a.image=c;return b};b.icon=function(c){if("undefined"===typeof c)return a.icon.value;a.icon.value=c;return b};b.iconStyle=function(c){if("undefined"===typeof c)return a.icon.style;a.icon.style=c;return b};b.created=function(){return a.created}})})();(function(){function a(a,c){var d=this;d.create=function(){return new c};d.createFromCurrentRecord=function(){return d.create().parseCurrentRecord()};return d}angular.module("favorites").factory("favoritesFactory",a);a.$inject=["$log","Favorite"]})();(function(){function a(a,c,d){function e(a){return new Promise(function(b,c){g.push(a.toObject());f().then(b)["catch"](c)})}function f(){return new Promise(function(a,b){setTimeout(function(){var b=void 0;g.length?b=sessionStorage.setItem(l.name,JSON.stringify(g)):sessionStorage.removeItem(l.name);a(b)},0)})}function k(a){"function"===typeof a&&(h.done?a.call():h.buffer.push(a))}var l={addFavorite:function(a){return new Promise(function(b,f){a instanceof c?(k(function(){e(a).then(b)["catch"](f)}),
d.favAdded()):f("storage.addFavorite(favorite) needs favorite instanceof Favorite !")})},removeFavorite:function(a){return new Promise(function(b,c){"number"!==typeof a?c("Invalid ID provided"):k(function(){for(var e=g.length,k=[],l=!1,t=0;t<e;++t)g[t].created===a?l=!0:k.push(g[t]);!1===l?c("Invalid ID provided"):(g=k,f().then(b)["catch"](c),0===g.length&&d.allFavsRemoved())})})},removeAllFavorites:function(){return new Promise(function(a,b){g=[];d.allFavsRemoved();f().then(a)["catch"](b)})},hasFavorite:function(a){return new Promise(function(b,
d){k(function(){var e=new RegExp("/"+a.replace(/\./,"\\."));if(g){var f=g.find(function(a){return!!a.title.link.match(e)});"undefined"===typeof f?d():b((new c).fromObject(f))}else d()})})},getFavorite:function(a){return new Promise(function(b,e){"number"===typeof a&&0<=a?k(function(){var e=favorite[a];d.favAdded();b((new c).fromObject(e))}):e("Cannot get favorite without an index")})},getFavorites:function(){return new Promise(function(a,b){k(function(){a(g.map(function(a){d.favAdded();return(new c).fromObject(a)}))})})},
name:"_favs"},g=[],h={done:!1,buffer:[]};(function(){setTimeout(function(){var a=sessionStorage.getItem(l.name);null!==a&&(g=JSON.parse(a));h.done=!0;h.buffer.forEach(function(a){a.call()})},0)})();return l}sessionStorage&&"setItem"in sessionStorage?(angular.module("favorites").factory("storage",a),a.$inject=["$log","Favorite","favsNotifications"]):console.error("This browser does not support sessionStorage, no favorites for not logged user can be provided!")})();(function(){function a(a,c,d,e){function f(a,b){localStorage.setItem(a,b);localStorage.removeItem(a)}function k(){function a(f){parseInt(f.key)===h&&("null"===f.newValue?sessionStorage.setItem(c.name,"[]"):(window.clearTimeout(b),sessionStorage.setItem(c.name,f.newValue),"function"===typeof window.__favChanged&&(f=JSON.parse(f.newValue),f.map(function(a){return(new d).fromObject(a)}).forEach(function(a){window.__favChanged(!0,a)}),f.length&&e.favAdded()),window.removeEventListener("storage",a)))}
h=Date.now();sessionStorage.tabId=h;window.addEventListener("storage",a);var b=window.setTimeout(function(){window.removeEventListener("storage",a);sessionStorage.setItem(c.name,"[]");g(!0)},1500);f("giveMeFavorites",h)}function l(){h=sessionStorage.tabId;var a=localStorage.favoritesMasterTab;a!==h&&"rand"!==a||g(!0)}function g(a){function b(a){"giveMeFavorites"==a.key&&a.newValue&&(r=a.newValue,f(a.newValue,sessionStorage.getItem(c.name)))}localStorage.setItem("favoritesMasterTab",h);window.onbeforeunload=
function(){window.removeEventListener("storage",b);localStorage.setItem("favoritesMasterTab",r?r:"rand")};window.addEventListener("storage",b)}"undefined"===typeof sessionStorage.tabId?k():l();window.addEventListener("storage",function(a){"favoritesMasterTab"===a.key?parseInt(a.newValue)!==h&&"rand"!==a.newValue||g():"favAdded"===a.key&&a.newValue?(a=JSON.parse(a.newValue),a=(new d).fromObject(a),c.addFavorite(a),"function"===typeof window.__favChanged&&window.__favChanged(!0,a)):"favRemoved"===a.key&&
a.newValue?(a=JSON.parse(a.newValue),a=(new d).fromObject(a),c.removeFavorite(a.created()),"function"===typeof window.__favChanged&&window.__favChanged(!1,a)):"purgeAllTabs"===a.key&&a.newValue&&c.removeAllFavorites()});(function(){"function"===typeof sendMeFavs&&!0===sendMeFavs()&&c.getFavorites().then(function(a){0!==a.length&&(a={favs:a.map(function(a){return a.toObject()})},$.post("/AJAX/JSON?method=pushFavorites",a).always(function(){f("purgeAllTabs");c.removeAllFavorites();location.reload()}))})})();
return{broadcastAdded:function(a){a=a.toObject();f("favAdded",JSON.stringify(a))},broadcastRemoved:function(a){f("favRemoved",a)}};var h,r}angular.module("favorites").factory("favsBroadcaster",a);a.$inject=["$log","storage","Favorite","favsNotifications"]})();(function(){function a(a,f,k,l,g,h,r){function q(a){(new Promise(function(c,d){g.removeFavorite(a).then(function(){b[a].remove();delete b[a];--m.listLength;0===Object.keys(b).length&&p();var c=parseInt(a);m.favorites=m.favorites.filter(function(a){if(a.created()!==c)return!0;h.broadcastRemoved(a);return!1})})["catch"](function(a){k.error(a)});c()})).then(l.$applyAsync)}function n(a){(new Promise(function(b,c){!a instanceof r?c():(m.favorites.push(a),t(w),1===m.favorites.length&&(p(),m.listLength=
1),b())})).then(l.$applyAsync)}function p(){c.hidden=!c.hidden;d.hidden=!d.hidden}function v(){var a=[];Object.keys(m.favSelected).forEach(function(b){!0===m.favSelected[b]&&(b=y(b),a.push(b))});return a}function u(a){function b(a){Lightbox.changeContent(a.data)}var c=v();if(0!==c.length){for(var d=0;d<c.length;++d)c[d]="Solr|"+c[d];c={ids:c};c[a]=!0;f.post("/AJAX/JSON?method=getLightbox&submodule=Cart&subaction=MyResearchBulk",$.param(c),{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(b);
x.modal("show")}}function t(a){(new Promise(function(b,c){var d=!0;switch(a){case "alphabetical":m.favorites.sort(function(a,b){return a.title()>b.title()});break;case "author":m.favorites.sort(function(a,b){return a.author()>b.author()});break;case "recent":m.favorites.sort(function(a,b){return a.created()<b.created()});break;default:d=!1,k.error("Invalid sorting provided")}d&&(w=a)})).then(l.$applyAsync)}function y(a){var b=m.favorites.find(function(b){return b.created()===parseInt(a)});if("undefined"!==
typeof b)return b.titleLink().replace("/Record/","")}var w="recent",x=$("#modal"),m=this;m.favSelected={};m.favorites=[];m.sortVal=function(a){return arguments.length?t(a):w};m.allSelected=!1;m.listStart=1;m.listLength=1;m.selectAll=function(){m.favorites.forEach(function(a){m.favSelected[a.created()]=m.allSelected})};m.removeFavorite=q;m.removeSelected=function(){Object.keys(m.favSelected).forEach(function(a){!0===m.favSelected[a]&&(q(parseInt(a)),delete m.favSelected[a])})};m.emailSelected=function(a){x.find(".modal-title").html(a.target.value);
Lightbox.titleSet=!0;u("email")};m.exportSelected=function(){Lightbox.titleSet=!1;u("export")};m.printSelected=function(){var a=v();if(0!==a.length){var b="/Records/Home?print=1";a.forEach(function(a){b+="&id[]=Solr|"+a});window.open(b,"_blank").focus()}};a.resolve(g.getFavorites()).then(function(a){a=a.reverse();m.favorites=a;if(a=a.length)p(),m.listLength=a})["catch"](function(a){k.error(a)});window.__favChanged=function(a,c){c instanceof r&&(!0===a?n(c):!1===a&&(new Promise(function(a,d){var e=
c.created();b[e].remove();delete b[e];--m.listLength;0===Object.keys(b).length&&p();m.favorites=m.favorites.filter(function(a){return a.created()!==c.created()});a()})).then(l.$applyAsync))}}angular.module("favorites").controller("ListController",a).directive("favoritesListItem",function(){return{restrict:"A",templateUrl:"/themes/cpk-devel/js/ng-cpk/favorites/list-item.html",link:function(a,c,d){b[a.fav.created()]=c.context}}}).directive("listNotEmpty",function(){return{restrict:"A",link:function(a,
b,k){"true"===k.listNotEmpty?(d=b.context,d.hidden=!0):"false"===k.listNotEmpty&&(c=b.context,c.hidden=!1)}}});a.$inject="$q $http $log $scope storage favsBroadcaster Favorite".split(" ");var b={},c=void 0,d=void 0})();(function(){function a(a,d,e,f,k){function l(){n=e.createFromCurrentRecord();d.addFavorite(n).then(function(){q();k.broadcastAdded(n)})["catch"](function(b){a.error(b)})}function g(){var b=n.created();d.removeFavorite(b).then(function(){q();k.broadcastRemoved(n)})["catch"](function(b){a.error(b)})}function h(){return new Promise(function(a,b){var c=r();d.hasFavorite(c).then(function(b){a(b)})["catch"](b)})}function r(a){return("undefined"===typeof a?location.pathname:a).split("/")[2]}function q(){b.remFavBtn.hidden=
!b.remFavBtn.hidden;b.addFavBtn.hidden=!b.addFavBtn.hidden;p=!p}var n=void 0,p=!1;this.addOrRemoveFavorite=function(){p?g():l()};this.isFavorite=h;h().then(function(a){n=a;q()});window.__favChanged=function(a,b){b instanceof f&&(!0===a?!1===p&&r(b.titleLink())===r()&&(n=b,q()):!1===a&&!0===p&&b.created()===n.created()&&(n=b,q()))}}angular.module("favorites").controller("RecordFavController",a).directive("addRemove",function(){return{restrict:"A",link:function(a,d,e){"add"===d.context.getAttribute("add-remove")?
(b.addFavBtn=d.context,d.context.hidden=!1):"rem"===d.context.getAttribute("add-remove")&&(b.remFavBtn=d.context,d.context.hidden=!0)}}});a.$inject=["$log","storage","favoritesFactory","Favorite","favsBroadcaster"];var b={remFavBtn:void 0,addFavBtn:void 0}})();(function(){angular.module("federativeLogin",[])})();(function(){function a(a){function d(){!1===k&&e();return f}function e(){f=localStorage.getItem("__luidps");if(null===f)f=[];else{try{f=JSON.parse(f)}catch(b){a.error("Could not parse lastIdps from localStorage",b),f=[]}var d=document.body.parentNode.getAttribute("lang");f.forEach(function(a){a.name=a["name_"+d]})}k=!0}var f=[],k=!1,l=!0;this.login=function(a){"string"===typeof a&&(a=JSON.parse(a));if(!a.isConsolidation){d();f.find(function(b,c){if(b.href===a.href)return f.splice(c,1),!0});f.unshift(a);
3<f.length&&f.pop();var b=JSON.stringify(f);localStorage.setItem("__luidps",b)}window.location=a.href};this.hasLastIdps=function(){d();return null!==f&&f instanceof Array&&0!==f.length};this.getLastIdps=d;this.showHelpContent=function(){l?b.helpContent.removeAttribute("hidden"):b.helpContent.setAttribute("hidden","hidden");l=!l};return this}angular.module("federativeLogin").controller("FederativeLoginController",a).directive("ngLastUsed",function(){return{restrict:"A",templateUrl:"/themes/cpk-devel/js/ng-cpk/federative-login/last-used.html"}}).directive("ngHelpContent",
function(){return{restrict:"A",link:function(a,d,e){b.helpContent=d.context}}});a.$inject=["$log"];var b={lastUsed:void 0}})();(function(){angular.module("notifications",[])})();(function(){function a(a,b,l,g,h){function r(a){return new Promise(function(c,d){l.post("/AJAX/JSON?method=getMyNotificationsForUserCard",$.param({cat_username:a}),{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(a){a=a.data.data;"object"===typeof a.errors&&a.errors.forEach(function(a){b.error(a)});"undefined"!==typeof a.notifications?c(a.notifications):d("No notifications returned!")},function(a){d(a)})})}function q(){return new Promise(function(a,c){l({method:"GET",
url:"/AJAX/JSON?method=getMyNotificationsForUser"}).then(function(d){d=d.data.data;"object"===typeof d.errors&&d.errors.forEach(function(a){b.error(a)});"undefined"!==typeof d.notifications?a(d.notifications):c("No notifications returned!")},function(a){c(a)})})}function n(){var a="object"===typeof t.notifications.noAPI.user&&0!==t.notifications.noAPI.user.length;return 0!==c.synchronousNotifications.children.length||a}function p(){v=!0;"function"===typeof u&&u.call()}var v=!1,u,t=this;t.notifications=
{};t.initApiRelevantNotificationsForUserCard=function(e,l){t.notifications[l]=[];a.resolve(r(l)).then(function(a){if(a instanceof Array){t.notifications[l]=a;if(0!==a.length||n())c.warningIcon.style="";"undefined"===typeof e?c.loader.setAttribute("hidden","hidden"):d[e].setAttribute("hidden","hidden");n()||c.withoutNotifications.removeAttribute("hidden")}})["catch"](function(a){b.error(a)})};t.initApiNonrelevantNotifications=function(){t.notifications.noAPI={};t.notifications.noAPI.user=[];a.resolve(q()).then(function(a){a instanceof
Array&&(t.notifications.noAPI.user=a,0!==a.length||n())&&(c.warningIcon.style="");p()})["catch"](function(a){b.error(a);p()})};t.notifClicked=function(a,b,c){"undefined"!==typeof a&&l.post("/AJAX/JSON?method=notificationRead",$.param({notificationType:b,source:c}),{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(){g.url()===a&&h.$broadcast("notificationClicked");g.url(a)})};e=function(){n()?c.warningIcon.style="":v?c.withoutNotifications.removeAttribute("hidden"):u=e};
return t}function b(a){return{restrict:"A",link:function(a,b,d){switch(d.globalNotif){case "loader":c.loader=b.context;break;case "withoutNotifications":c.withoutNotifications=b.context;break;case "synchronousNotifications":c.synchronousNotifications=b.context;break;case "warningIcon":c.warningIcon=b.context;break;default:console.error("Linker for notifications controller failed to link global notifications element")}"undefined"===typeof buf&&(buf={},buf.globalNotifHolderKeys=Object.keys(c),buf.globalNotifHolderKeysLength=
buf.globalNotifHolderKeys.length);for(a=0;a<buf.globalNotifHolderKeysLength&&"undefined"!==typeof c[buf.globalNotifHolderKeys[a]];)++a===buf.globalNotifHolderKeysLength&&("function"===typeof e?e():$log.error("onLinkerDone must be a function"))}}}angular.module("notifications").controller("NotificationsController",a).directive("globalNotif",b).directive("institutionNotif",function(){return{restrict:"A",link:function(a,b,c){d[c.institutionNotif]=b.context}}});a.$inject=["$q","$log","$http","$location",
"$rootScope"];b.$inject=["$log"];var c={loader:void 0,withoutNotifications:void 0,synchronousNotifications:void 0,warningIcon:void 0},d={},e=function(){}})();(function(){angular.module("admin",[])})();(function(){angular.module("history",[])})();(function(){function a(a,d,e,f){function k(b){n.removeAttribute("hidden");u.historyPage=[];p=b;r();a.resolve(l()).then(function(a){var b=a.historyPage;(new Promise(function(a){n.setAttribute("hidden","hidden");u.historyPage=b;return a()})).then(f.$applyAsync)})["catch"](function(a){d.error(a)})}function l(){return new Promise(function(a,b){var c=p-1;if("undefined"!==typeof v[c])return a(v[c]);e.post("/AJAX/JSON?method=getMyHistoryPage",$.param({cat_username:q,page:p,perPage:u.perPage}),{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){e=
e.data;"undefined"!==typeof e.php_errors&&d.error(e.php_errors);return"OK"===e.status?(v[c]=e.data,a(e.data)):b(e.data)})})}function g(b,d){n=b;q=d;a.resolve(l()).then(function(a){var b=a.historyPage;v=Array(a.totalPages);v[0]=a;h();(new Promise(function(a){n.setAttribute("hidden","hidden");u.historyPage=b;a()})).then(f.$applyAsync)})["catch"](function(a){n.innerHTML=a.message})}function h(){for(var a=[],b=[],c=v.length,d=0;d<c;)b[d++]={number:d,clazz:1===d?"active":""},5>=d&&(a[d-1]=b[d-1]);f.paginator=
{lastPage:c,visiblePages:a,pages:b,activePage:1,showFirst:!1,showLast:5<c,goToPage:k}}function r(){(new Promise(function(a){var b=f.paginator.pages;b[f.paginator.activePage-1].clazz="";b[p-1].clazz="active";var c=f.paginator.lastPage,d=3<p,e=p<c-2,l=[],g=p+2,h=3;g>c&&(h=g-c+h,g=c);for(var h=p-h,n=0;h<g;++n,++h)0>h&&(g-=h,g>c&&(g=c),h=0),e&&h===c-1||d&&0===h?--n:l[n]=b[h];f.paginator={lastPage:c,visiblePages:l,pages:b,activePage:p,showFirst:d,showLast:e,goToPage:k};a()})).then(f.$applyAsync)}var q=
void 0,n=void 0,p=1,v=[];b=g;var u=this;u.historyPage=[];u.pageSelected=k;u.perPage="10";u.perPageUpdated=function(){(new Promise(function(a){p=f.paginator.lastPage=1;u.historyPage=[];n.removeAttribute("hidden");a()})).then(f.$applyAsync);v=[];g(n,q)};return u}angular.module("history").controller("CheckedOutHistoryController",a).directive("ngHistoryUsername",function(){return{restrict:"A",link:function(a,d,e){b(d.context,e.ngHistoryUsername)}}}).directive("ngHistoryItem",function(){return{restrict:"A",
templateUrl:"/themes/cpk-devel/js/ng-cpk/history/history-item.html"}}).directive("ngPagination",function(){return{restrict:"A",templateUrl:"/themes/cpk-devel/js/ng-cpk/pagination.html",link:function(a,b,e){a.source=e.ngPagination}}});a.$inject=["$q","$log","$http","$scope"];var b=function(){}})();(function(){angular.module("cpk",["favorites","notifications","federativeLogin","admin","history"]).config(["$locationProvider",function(a){a.html5Mode({enabled:!0,requireBase:!1})}])})();(function(){function a(a,d,l,g,h){function r(a){b("global",function(){new Promise(function(){"undefined"===typeof e&&(e=$("#modal"));e.modal("show")});var b=c.modal.global.header,d=c.modal.global.body;h.get("/AJAX/JSON?method=getPortalPage&prettyUrl="+a).then(function(a){a=a.data.data;b.innerHTML='<h4 class="modal-title">'+a.title+"</h4>";d.innerHTML=a.content},function(a){g.error(a)})})}var q=this;q.getParams=l.search();"undefined"!==typeof q.getParams.viewModal&&r(q.getParams.viewModal);d.$on("notificationClicked",
function(){q.getParams=l.search();"undefined"!==typeof q.getParams.viewModal&&r(q.getParams.viewModal,g,h)});return q}function b(a,b){"undefined"===typeof d.modal[a]&&(d.modal[a]={});if("function"===typeof b){var e=d.modal[a].linkerDone;"boolean"===typeof e&&e?b.call():d.modal[a].callback=b}else{for(var e=!0,g=Object.keys(c.modal[a]),h=g.length,r=0;r<h;++r)if("undefined"===typeof c.modal[a][g[r]]){e=!1;break}e&&(d.modal[a].linkerDone=!0,"function"===typeof d.modal[a].callback&&d.modal[a].callback.call())}}
angular.module("cpk").controller("GlobalController",a).directive("ngModal",function(){return{restrict:"A",link:function(a,d,e){a=$jscomp.makeIterator(e.ngModal.split("."));modalId=a.next().value;modalPart=a.next().value;"undefined"===typeof c.modal[modalId]&&(c.modal[modalId]={});c.modal[modalId][modalPart]=d.context;b(modalId,modalPart)}}});a.$inject=["favsBroadcaster","$rootScope","$location","$log","$http"];var c={modal:{global:{body:void 0,header:void 0}}},d={modal:{}},e=void 0})();(function(){angular.module("cpk").filter("translate",function(){return function(a){return"translate"in VuFind?VuFind.translate(a):a}})})();
